[
    {
        "name": "general_hallucination_check",
        "task_description": "Evaluate whether each parameter value in the function call is correct and **directly supported** by the provided conversation history and adhere the tool specifications. Your assessment must be based **strictly on explicit evidence** from these sources and correctly formatted based on the API specifications. Do **not** assume or hallucinate any information that is not clearly documented and provided.\n\n---\n\n#### 1. Grounding Sources\n\nA parameter value is considered grounded if it originates from one of the following:\n\n- An explicit user message in the conversation  \n- An assistant message that the user confirmed or acknowledged  \n- The output of a previous tool call  \n- A documented default value in the API specification  \n\n---\n\n#### 2. Parameter Value Classification\n\nEach parameter value must be labeled using one of the following categories:\n\n- **CORRECT**  \n  The value is explicitly mentioned, clearly implied in the conversation, or matches a documented default.\n\n- **MISSING_INFORMATION**  \n  The value is underspecified or incomplete given the current context (e.g., '05/06' when a full date is required).\n\n- **FORMAT ERROR**  \n  The value is conceptually correct but incorrectly formatted (e.g., wrong units, casing, or structure) based on the API specifications and descriptions.\n\n- **CONTRADICTORY_VALUES**  \n  The value violates documented constraints or logical relationships between parameters (e.g., `start_time` should be < `end_time`).\n\n- **DEFAULT_ISSUE**  \n  The default value of the parameter is not the correct value based on the conversation history.\n\n---\n\n#### 3. Handling Default Values\n\n- Optional parameters may only use default values that are **explicitly documented** in the API specification.  \n- Defaults that are assumed or undocumented count as hallucinations.  \n- If no value is provided and no default exists, the parameter should be omitted.\n\n---\n\n#### 4. Acceptable Transformations\n\nSome transformations are permitted, but only when grounded:\n\n- **Synonyms** (e.g., \"NYC\" -> \"New York\") are allowed only when normalized in the conversation.  \n- **Unit conversions** are valid only if the conversation explicitly mentions the conversion.  \n- **Format changes** (e.g., date or time reformatting) are acceptable only if acknowledged by the assistant or supported by the specification.\n\n---\n\n#### 5. Multi-Call Context\n\nIf the tool call appears in a sequence:\n\n- You may use outputs from earlier tool calls to justify parameter values.  \n- Consider dependencies and ordering between calls when assessing grounding.  \n\n---\n\n#### Conservative Judgment Principle\n\nWhen in doubt, err on the side of caution. If grounding cannot be clearly established, treat the parameter as incorrect.\n",
        "jsonschema": {
            "title": "general_hallucination_check",
            "description": "Assessment of tool call grounding accuracy, following the rubric defined above.",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "evidence": {
                    "type": "string",
                    "description": "Provide EXACT quotes from user messages, assistant responses, prior tool outputs, or API specifications that demonstrate whether each parameter value is grounded. Do not paraphrase or interpret-use only direct evidence."
                },
                "explanation": {
                    "type": "string",
                    "description": "For EACH parameter value, explain its grounding status by citing specific evidence from the conversation history or tool specification. Address whether the value is correctly grounded, hallucinated, needs more information, has format errors, or contradicts other parameters. Include direct quotes that support or contradict the value."
                },
                "output": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5,
                    "threshold_low": 4,
                    "threshold_high": 5,
                    "description": "Reflection Quality Score (1-5):\n\n- 5: All values are correct - fully grounded and well-formatted.\n  All parameter values are explicitly grounded in the conversation or tool output, and exactly match the expected types, formats, and units.\n  Example:\n  User: \"Book a hotel in Paris for two adults from August 10th to 12th.\"\n  \u2192 Tool call includes: location: \"Paris\", guests: 2, check_in: \"2025-08-10\", check_out: \"2025-08-12\"\n\n- 4: All values are correct based on the conversation history and tool specifications - can be logically inferred (can be implicitly grounded).\n  Some parameter values are not directly mentioned but can be logically inferred from the context. No evidence of hallucination.\n  Example:\n  User: \"I want to book a hotel in Tokyo for me and my wife.\"\n  \u2192 Tool call includes: location: \"Tokyo\", guests: 2\n\n- 3: One or more values are probably incorrect or ungrounded - ambiguous or undetermined\n  It's unclear whether some parameter values are grounded. They might be inferred, hallucinated, or drawn from partial context, or some parameter values partially match the expected format but are likely to be rejected or misinterpreted by automatic processing.\n  Example:\n  User: \"Book a hotel in Rome.\"\n  \u2192 Tool call includes: location: \"Rome\", guests: 2\n\n- 2: One or more values are probably incorrect - likely hallucinated or incorrect format.\n  Several parameter values do not align with the conversation context and are likely hallucinated, or have format errors.\n  Example:\n  User: \"Find a hotel.\"\n  \u2192 Tool call includes: location: \"New York\", guests: 4\n\n- 1: One or more values are clearly incorrect - certainly hallucinated or fabricated.\n  Some parameter values are clearly invented, irrelevant, contradict known context, or do not follow the API specifications.\n  Example:\n  User: \"Remind me to call John.\"\n  \u2192 Tool call includes: location: \"Barcelona\", guests: 6, check_in: \"2025-07-01\""
                },
                "confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "threshold_low": 0,
                    "threshold_high": 1,
                    "description": "Confidence in the accuracy of this assessment (range: 0.0-1.0). Assign higher confidence when evidence is clear, complete, and consistent, and lower confidence when it is ambiguous, incomplete, or conflicting."
                },
                "correction": {
                    "type": "object",
                    "description": "Corrections to the tool call. If there are no issues, provide an empty object {}. If there are issues, include parameter_issues and optionally a corrected tool_call if a full reconstruction is possible.",
                    "properties": {
                        "parameter_issues": {
                            "type": "array",
                            "description": "List of parameters with issues. Leave empty if no issues were found.",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "parameter_name": {
                                        "type": "string",
                                        "description": "Name of the parameter with an issue."
                                    },
                                    "reason_types": {
                                        "type": "array",
                                        "description": "List of issue categories affecting this parameter.",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "MISSING_INFORMATION",
                                                "FORMAT_ERROR",
                                                "CONTRADICTORY_VALUES",
                                                "DEFAULT_ISSUE",
                                                "OTHER"
                                            ]
                                        }
                                    },
                                    "reasons": {
                                        "type": "string",
                                        "description": "Brief explanation of the issue(s) affecting this parameter."
                                    },
                                    "corrected_value": {
                                        "type": "object",
                                        "description": "Object containing parameter name as key and corrected value as value. Use 'need_more_information' as the key and clarification question for the user if additional information is required. Use 'need_more_tool_calls' if the value cannot be corrected without additional tool calls. If the value is well-grounded, return an empty object {}.",
                                        "additionalProperties": true
                                    }
                                },
                                "required": []
                            }
                        },
                        "tool_call": {
                            "type": "object",
                            "description": "Optional complete corrected tool call. Include only if all corrected values are available and no values require further user input.",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "Name of the function to call."
                                },
                                "arguments": {
                                    "type": "object",
                                    "description": "Full set of corrected arguments for the function call, including both modified and retained values.",
                                    "additionalProperties": true
                                }
                            },
                            "required": []
                        }
                    },
                    "required": []
                },
                "actionable_recommendations": {
                    "type": "array",
                    "description": "Provide clear, actionable recommendations that can be automatically applied to prevent similar issues. Only include recommendations when there are actual issues (output <= 3). Focus on:\n\n1. PARAMETER_DOCUMENTATION: Add or update parameter documentation to clarify requirements, formats, or defaults.\n2. PARAMETER_EXAMPLES: Add concrete examples showing correct parameter usage.\n3. SYSTEM_PROMPT_INSTRUCTION: Add a general instruction to the system prompt (do not mention specific parameter names).",
                    "items": {
                        "type": "object",
                        "properties": {
                            "recommendation": {
                                "type": "string",
                                "enum": [
                                    "PARAMETER_DOCUMENTATION",
                                    "PARAMETER_EXAMPLES",
                                    "SYSTEM_PROMPT_INSTRUCTION"
                                ],
                                "description": "The type of recommendation being made."
                            },
                            "parameter_name": {
                                "type": "string",
                                "description": "The name of the parameter to which the recommendation applies. Omit for SYSTEM_PROMPT_INSTRUCTION."
                            },
                            "details": {
                                "type": "string",
                                "description": "Brief explanation of what should be changed and why."
                            },
                            "quote": {
                                "type": "string",
                                "description": "Exact text to add to documentation or system prompt. Must be directly usable without modification."
                            }
                        },
                        "required": [
                            "recommendation",
                            "details",
                            "quote"
                        ]
                    }
                }
            },
            "required": [
                "evidence",
                "explanation",
                "output",
                "confidence",
                "correction",
                "actionable_recommendations"
            ]
        },
        "examples": [
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "system",
                            "content": "You are an helpful assistant."
                        },
                        {
                            "role": "user",
                            "content": "Can you show me my profile details?"
                        },
                        {
                            "role": "assistant",
                            "content": "Logged in as user 55; auth token acquired."
                        },
                        {
                            "role": "assistant",
                            "content": "Ready to fetch your profile."
                        }
                    ],
                    "tool_inventory": [
                        {
                            "type": "function",
                            "function": {
                                "name": "get_user_profile",
                                "description": "Retrieves a user's profile details",
                                "parameters": {
                                    "type": "object",
                                    "properties": {
                                        "user_id": {
                                            "type": "integer",
                                            "description": "The ID of the user whose profile is being retrieved"
                                        }
                                    },
                                    "required": [
                                        "user_id"
                                    ]
                                }
                            }
                        }
                    ],
                    "tool_call": {
                        "id": "call_001",
                        "type": "function",
                        "function": {
                            "name": "get_user_profile",
                            "arguments": "{ \"user_id\": 55 }"
                        }
                    }
                },
                "output": {
                    "evidence": "Assistant message: \"Logged in as user 55; auth token acquired.\"",
                    "explanation": "The parameter value user_id=55 is directly grounded in the conversation history. The assistant's message explicitly states \"Logged in as user 55\", providing the exact user_id that is used in the tool call. This is a clear example of proper grounding from conversation context.",
                    "output": 5,
                    "confidence": 0.99,
                    "correction": {},
                    "actionable_recommendations": []
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                    {
                        "role": "system",
                        "content": "You are an helpful assistant."
                    },
                    {
                        "role": "user",
                        "content": "Can you show me my profile details?"
                    }
                    ],
                    "tool_inventory": [
                    {
                        "type": "function",
                        "function": {
                        "name": "get_user_profile",
                        "description": "Retrieves a user's profile details",
                        "parameters": {
                            "type": "object",
                            "properties": {
                            "user_id": {
                                "type": "integer",
                                "description": "The ID of the user whose profile is being retrieved"
                            }
                            },
                            "required": ["user_id"]
                        }
                        }
                    }
                    ],
                    "tool_call": {
                    "id": "call_001",
                    "type": "function",
                    "function": {
                        "name": "get_user_profile",
                        "arguments": "{ \"user_id\": 12345 }"
                    }
                    }
                },
                "output": {
                    "evidence": "User never mentioned an ID. Tool spec requires user_id but does not define a default. The assistant fabricated '12345'.",
                    "explanation": "The assistant hallucinated a user_id value with no grounding in conversation or tool specification.",
                    "output": 1,
                    "confidence": 1,
                    "correction": {
                    "parameter_issues": [
                        {
                        "parameter_name": "user_id",
                        "reason_types": ["MISSING_INFORMATION"],
                        "reasons": "No user ID in context or conversation. The assistant invented '12345'.",
                        "corrected_value": {
                            "need_more_information": "Please provide your user ID so I can fetch the profile."
                        }
                        }
                    ]
                    },
                    "actionable_recommendations": [
                    {
                        "recommendation": "PARAMETER_DOCUMENTATION",
                        "parameter_name": "user_id",
                        "details": "Clarify that user_id must come from conversation or authentication, never assumed.",
                        "quote": "Required. Must be explicitly provided by the user or obtained from a prior authentication tool call. Never assume or fabricate this value."
                    },
                    {
                        "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                        "details": "Add instruction to never fabricate parameter values.",
                        "quote": "Never invent or fabricate parameter values. If required information is missing from the conversation, ask the user to provide it before making tool calls."
                    }
                    ]
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                    {
                        "role": "system",
                        "content": "You are a travel booking assistant."
                    },
                    {
                        "role": "user",
                        "content": "Book me a flight to Paris on September 15th."
                    }
                    ],
                    "tool_inventory": [
                    {
                        "type": "function",
                        "function": {
                        "name": "book_flight",
                        "description": "Books a flight to a specified destination on a given date.",
                        "parameters": {
                            "type": "object",
                            "properties": {
                            "destination": {
                                "type": "string",
                                "description": "The destination city or airport for the flight."
                            },
                            "departure_date": {
                                "type": "string",
                                "description": "The date of departure, in YYYY-MM-DD format."
                            },
                            "seat_class": {
                                "type": "string",
                                "description": "Seat class: economy, business, or first.",
                                "enum": ["economy", "business", "first"]
                            }
                            },
                            "required": ["destination", "departure_date", "seat_class"]
                        }
                        }
                    }
                    ],
                    "tool_call": {
                    "id": "call_002",
                    "type": "function",
                    "function": {
                        "name": "book_flight",
                        "arguments": "{ \"destination\": \"Paris\", \"departure_date\": \"2025-09-15\", \"seat_class\": \"first\" }"
                    }
                    }
                },
                "output": {
                    "evidence": "User asked for flight to Paris on 2025-09-15 but never specified seat_class. Assistant hallucinated 'first'.",
                    "explanation": "The destination and date are grounded. The seat_class parameter is hallucinated because the user never mentioned it.",
                    "output": 1,
                    "confidence": 0.92,
                    "correction": {
                    "parameter_issues": [
                        {
                        "parameter_name": "seat_class",
                        "reason_types": ["MISSING_INFORMATION"],
                        "reasons": "Seat class was never provided by the user or tool defaults.",
                        "corrected_value": {
                            "need_more_information": "Which seat class would you like: economy, business, or first?"
                        }
                        }
                    ]
                    },
                    "actionable_recommendations": [
                    {
                        "recommendation": "PARAMETER_DOCUMENTATION",
                        "parameter_name": "seat_class",
                        "details": "Clarify that seat_class is required and has no default value.",
                        "quote": "Required. Must be explicitly provided by the user. Valid values: economy, business, first. No default value."
                    },
                    {
                        "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                        "details": "Add instruction to confirm required parameters before tool calls.",
                        "quote": "Before making tool calls, ensure all required parameters have been provided by the user. If any required information is missing, ask the user for it."
                    }
                    ]
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                    {
                        "role": "system",
                        "content": "You are a flight booking assistant."
                    },
                    {
                        "role": "user",
                        "content": "I want to fly to Rome on 15/09/2025 in economy class."
                    }
                    ],
                    "tool_inventory": [
                    {
                        "type": "function",
                        "function": {
                        "name": "book_flight",
                        "description": "Books a flight to a specified destination on a given date.",
                        "parameters": {
                            "type": "object",
                            "properties": {
                            "destination": { "type": "string" },
                            "departure_date": { "type": "string", "description": "Date in YYYY-MM-DD format" },
                            "seat_class": {
                                "type": "string",
                                "enum": ["economy", "business", "first"]
                            }
                            },
                            "required": ["destination", "departure_date", "seat_class"]
                        }
                        }
                    }
                    ],
                    "tool_call": {
                    "id": "call_003",
                    "type": "function",
                    "function": {
                        "name": "book_flight",
                        "arguments": "{ \"destination\": \"Rome\", \"departure_date\": \"15/09/2025\", \"seat_class\": \"economy\" }"
                    }
                    }
                },
                "output": {
                    "evidence": "User provided date as '15/09/2025'. Tool spec requires YYYY-MM-DD. Assistant forwarded incorrect format directly.",
                    "explanation": "All parameters are grounded, but departure_date is in the wrong format.",
                    "output": 2,
                    "confidence": 0.95,
                    "correction": {
                    "parameter_issues": [
                        {
                        "parameter_name": "departure_date",
                        "reason_types": ["FORMAT_ERROR"],
                        "reasons": "Expected 'YYYY-MM-DD'. Received '15/09/2025'.",
                        "corrected_value": { "departure_date": "2025-09-15" }
                        }
                    ]
                    },
                    "actionable_recommendations": [
                    {
                        "recommendation": "PARAMETER_DOCUMENTATION",
                        "parameter_name": "departure_date",
                        "details": "Specify exact date format requirement.",
                        "quote": "Required format: YYYY-MM-DD (e.g., 2025-09-15). Always convert user-provided dates to this format before making the tool call."
                    },
                    {
                        "recommendation": "PARAMETER_EXAMPLES",
                        "parameter_name": "departure_date",
                        "details": "Show example of date format conversion.",
                        "quote": "Example: User says '15/09/2025' â†’ convert to '2025-09-15' before calling the tool."
                    },
                    {
                        "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                        "details": "Add instruction to convert dates to required formats.",
                        "quote": "Always convert dates and times to the exact format specified in the API documentation before making tool calls, regardless of how the user provides them."
                    }
                    ]
                }
            }
        ]
    },
    {
        "name": "general_value_format_alignment",
        "task_description": "Evaluate whether ALL parameter values in the function call conform to the required type, format, and unit conventions defined in the API specification.\n\nYour judgment must be strictly evidence-based: rely exclusively on the provided API documentation and the parameter values. Do not assume or infer formatting rules that are not explicitly documented.\n\nIMPORTANT: Evaluate ALL parameter values in the tool call to ensure they meet the exact type, format, and unit requirements. Consider the collective format compliance of the entire function call.\n---\n\n### 1. Data Type Compliance\n- Check that each value matches the required data type (e.g., string, integer, boolean, object, array)\n- Verify that numbers are represented as numeric types, not strings\n- Ensure strings are quoted correctly if required\n- Confirm booleans are true/false (not \"true\"/\"false\") when the type is boolean\n\n---\n\n### 2. Format Specification Compliance\n- Validate adherence to documented format constraints for each parameter, including:\n  - Date and time formats (e.g., ISO 8601, YYYY-MM-DD, timezone presence)\n  - Currency (e.g., $USD, symbol placement, decimal precision)\n  - Special patterns (e.g., phone numbers, email addresses, postal codes)\n- Enforce regular expressions or formatting rules defined in the schema\n\n---\n\n### 3. Unit Compliance\n- Verify presence or absence of unit suffixes/prefixes as specified (e.g., \"kg\", \"seconds\")\n- Confirm unit types are consistent with spec (e.g., Celsius vs Fahrenheit)\n- Reject any extra units when raw values are required\n\n---\n\n### 4. Consistency Requirements\n- Ensure values are consistent with related parameters (e.g., both timestamps in UTC)\n- Validate compatibility between parameter values in the same call\n- Check that parameter relationships don't violate constraints\n\n---\n\n### Format Alignment Rating Scale\n- **5 - Perfect Alignment**: All parameter values exactly match required types, formats, and units\n- **4 - Minor Deviation**: All values are fundamentally correct but some have minor formatting issues that are still likely to be accepted by the API or parser unless strict validation is enforced\n- **3 - Moderate Deviation**: Some parameter types or formats are partially incorrect; may cause issues\n- **2 - Major Deviation**: Multiple parameters have significant type and format violations; likely to fail\n- **1 - Complete Mismatch**: One or more parameter values are entirely incompatible with specification\n\n---\n\n### Final Rule\nBe conservative in your assessment:\n- If the spec is ambiguous and values seem plausible, prefer a higher score (4-5)\n- If the spec is clear and values deviate, assign a lower score (1-3)\n- Consider the cumulative impact of all format issues across parameters\n\nYour evaluation is critical: even minor formatting issues can lead to tool failures or incorrect outputs. Careful review ensures reliability in downstream tool use.",
        "jsonschema": {
            "title": "general_value_format_alignment",
            "description": "Assessment of all parameter values' compliance with required type, format, and unit specifications, based on the rubric above.",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "evidence": {
                    "type": "string",
                    "description": "Quote the specification's type/format definitions for each parameter and include the actual parameter values provided. Cite EXACT text from the tool specification that supports your judgment."
                },
                "explanation": {
                    "type": "string",
                    "description": "For each parameter value, explain why it conforms or does not conform to the specification's requirements. Address data type, format, units, and any pattern or constraint violations. For incorrect values, describe exactly what is wrong and how it affects the overall tool call."
                },
                "output": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5,
                    "threshold_low": 4,
                    "threshold_high": 5,
                    "description": "An integer from 1 to 5 indicating how well all parameter values conform to the required types, formats, and units as defined in the API specification.\n\nScore meanings:\n\n5 - Perfect Alignment: All parameter values exactly match the expected types, formats, and units. Example: all dates in 'YYYY-MM-DD', all numbers as integers, all strings properly formatted.\n\n4 - Minor Deviation: All values are fundamentally correct but some have small formatting issues (e.g., missing leading zeros) that are still likely to be accepted by the API or parser unless strict validation is enforced. Example: expected '2025-08-05', value is '2025-8-5'.\n\n3 - Moderate Deviation: Some parameter values partially match the expected format but are likely to be rejected or misinterpreted by automatic processing. Example: mix of correct and incorrectly formatted dates.\n\n2 - Major Deviation: Multiple parameter values significantly violate the expected type, format, or unit and are very likely to fail. Example: wrong data types, completely wrong formats.\n\n1 - Complete Mismatch: One or more parameter values are entirely incompatible with the required format or type. Example: expected boolean, value is 'maybe'; expected date, value is random text."
                },
                "confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "threshold_low": 0,
                    "threshold_high": 1,
                    "description": "Confidence in the accuracy of this assessment (range: 0.0-1.0). Assign higher confidence when evidence is clear, complete, and consistent, and lower confidence when it is ambiguous, incomplete, or conflicting."
                },
                "correction": {
                    "type": "object",
                    "description": "If output >= 4, return {}. If output <= 3, provide parameter_issues and a corrected tool_call.",
                    "properties": {
                        "parameter_issues": {
                            "type": "array",
                            "description": "List of parameters with format issues. Leave empty if no issues were found.",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "parameter_name": {
                                        "type": "string",
                                        "description": "Name of the parameter with a format issue."
                                    },
                                    "reason_types": {
                                        "type": "array",
                                        "description": "List of format issues identified. Use one or more of: TYPE_ERROR, FORMAT_ERROR, UNIT_ERROR, PATTERN_ERROR, CONSISTENCY_ERROR, OTHER.",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "TYPE_ERROR",
                                                "FORMAT_ERROR",
                                                "UNIT_ERROR",
                                                "PATTERN_ERROR",
                                                "CONSISTENCY_ERROR",
                                                "OTHER"
                                            ]
                                        }
                                    },
                                    "reasons": {
                                        "type": "string",
                                        "description": "Short explanation of the specific issue(s) with the parameter's format, type, or unit."
                                    },
                                    "corrected_value": {
                                        "type": "object",
                                        "description": "An object containing the corrected parameter value in the form: { \"<parameter_name>\": <corrected_value> }. If you cannot correct the value, use 'need_more_information' as the key and provide a clarification question for the user. Use 'need_more_tool_calls' if the value cannot be corrected without additional tool calls. If the value is well-formatted, return an empty object {}.",
                                        "additionalProperties": true
                                    }
                                },
                                "required": [
                                    "parameter_name",
                                    "reason_types",
                                    "reasons",
                                    "corrected_value"
                                ]
                            }
                        },
                        "tool_call": {
                            "type": "object",
                            "description": "Complete corrected tool call with all format issues fixed, including both modified and retained parameter values. Must be included if a full reconstruction is possible.",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "Name of the function to call."
                                },
                                "arguments": {
                                    "type": "object",
                                    "description": "Set of corrected arguments for the function call, with all format issues resolved.",
                                    "additionalProperties": true
                                }
                            },
                            "required": [
                                "name",
                                "arguments"
                            ]
                        }
                    },
                    "required": []
                },
                "actionable_recommendations": {
                    "type": "array",
                    "description": "Provide actionable suggestions for avoiding format errors in future tool calls, only if there are issues. Address root causes like unclear format specs, missing examples, or lack of validation. Include suggestions such as:\n\n1. PARAMETER_FORMAT_DOCUMENTATION: Clarify or expand parameter format expectations in the API documentation.\n2. PARAMETER_EXAMPLES: Add example values with correct formatting in the parameter documentation.\n3. PARAMETER_VALIDATION: Introduce regex or rule-based format validation in the API to catch errors before tool calls.\n4. PARAMETER_CONVERSION: Add conversion helpers for user input to ensure correct formatting.\n5. UNIT_STANDARDS: Standardize unit expectations and flag missing or incorrect units in the tools implementation.\n6. PARAMETER_NAMING_CONVENTIONS: Suggest clearer parameter names that indicate expected formats or units.\n7. SYSTEM_PROMPT_ADDITIONS: Recommend specific additions to the system prompt that would help the agent avoid similar format issues in the future.\n8. PRE_CALL_REFLECTION_STRATEGIES: Propose strategies for the agent to reflect on parameter values before making tool calls, such as checking format compliance.\n9. PARAMETER_SOURCE_TRACKING: Suggest implementing a mechanism to track where each parameter value originated from to improve transparency and debugging.\n10. CLARIFICATION_PROMPTS: Recommend adding clarification prompts when parameter values are ambiguous or missing expected formats.\n11. OTHER: Any other specific recommendations that would help prevent similar format issues in the future.",
                    "items": {
                        "type": "object",
                        "properties": {
                            "recommendation": {
                                "type": "string",
                                "description": "A specific, actionable recommendation to improve the agent's parameter formatting process.",
                                "enum": [
                                    "PARAMETER_FORMAT_DOCUMENTATION",
                                    "PARAMETER_EXAMPLES",
                                    "PARAMETER_VALIDATION",
                                    "PARAMETER_CONVERSION",
                                    "UNIT_STANDARDS",
                                    "PARAMETER_NAMING_CONVENTIONS",
                                    "SYSTEM_PROMPT_ADDITIONS",
                                    "PRE_CALL_REFLECTION_STRATEGIES",
                                    "PARAMETER_SOURCE_TRACKING",
                                    "CLARIFICATION_PROMPTS",
                                    "OTHER"
                                ]
                            },
                            "parameter_name": {
                                "type": "string",
                                "description": "The name of the parameter to which the recommendation applies."
                            },
                            "details": {
                                "type": "string",
                                "description": "Detailed explanation of the recommendation, including what specific changes should be made, how they will improve parameter formatting, and any relevant examples or best practices."
                            },
                            "quote": {
                                "type": "string",
                                "description": "The specific quote of the additions made to the documentation, examples, or instructions."
                            }
                        },
                        "required": [
                            "recommendation",
                            "parameter_name",
                            "details",
                            "quote"
                        ]
                    }
                }
            },
            "required": [
                "evidence",
                "explanation",
                "output",
                "confidence",
                "correction",
                "actionable_recommendations"
            ]
        },
        "examples": [
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "Book a flight to Paris on 2025-08-15 for 2 adults in economy class."
                        }
                    ],
                    "tool_inventory": [
                        {
                            "type": "function",
                            "function": {
                                "name": "book_flight",
                                "description": "Books a flight with specified parameters",
                                "parameters": {
                                    "type": "object",
                                    "properties": {
                                        "destination": {
                                            "type": "string",
                                            "description": "Destination city"
                                        },
                                        "departure_date": {
                                            "type": "string",
                                            "format": "date",
                                            "description": "Date in YYYY-MM-DD format"
                                        },
                                        "passengers": {
                                            "type": "integer",
                                            "description": "Number of passengers"
                                        },
                                        "class": {
                                            "type": "string",
                                            "enum": [
                                                "economy",
                                                "business",
                                                "first"
                                            ],
                                            "description": "Flight class"
                                        }
                                    },
                                    "required": [
                                        "destination",
                                        "departure_date",
                                        "passengers",
                                        "class"
                                    ]
                                }
                            }
                        }
                    ],
                    "tool_call": {
                        "id": "call_001",
                        "type": "function",
                        "function": {
                            "name": "book_flight",
                            "arguments": "{\"destination\": \"Paris\", \"departure_date\": \"2025-08-15\", \"passengers\": 2, \"class\": \"economy\"}"
                        }
                    }
                },
                "output": {
                    "evidence": "Tool spec requires: destination (string), departure_date (string, YYYY-MM-DD format), passengers (integer), class (enum: economy/business/first). Values provided: 'Paris' (string), '2025-08-15' (string, YYYY-MM-DD), 2 (integer), 'economy' (valid enum).",
                    "explanation": "All parameter values perfectly conform to their specifications: destination is a proper string, departure_date follows the exact YYYY-MM-DD format, passengers is provided as an integer (not string), and class matches one of the required enum values. No format issues detected.",
                    "output": 5,
                    "confidence": 0.98,
                    "correction": {},
                    "actionable_recommendations": []
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "Set a timer for 5 minutes and schedule a meeting for tomorrow at 3 PM."
                        }
                    ],
                    "tool_inventory": [
                        {
                            "type": "function",
                            "function": {
                                "name": "set_timer_and_meeting",
                                "description": "Sets a timer and schedules a meeting",
                                "parameters": {
                                    "type": "object",
                                    "properties": {
                                        "timer_duration": {
                                            "type": "string",
                                            "description": "Duration in format 'number unit' (e.g., '5 minutes')"
                                        },
                                        "meeting_date": {
                                            "type": "string",
                                            "description": "Date in YYYY-MM-DD format"
                                        },
                                        "meeting_time": {
                                            "type": "string",
                                            "description": "Time in HH:MM 24-hour format"
                                        }
                                    },
                                    "required": [
                                        "timer_duration",
                                        "meeting_date",
                                        "meeting_time"
                                    ]
                                }
                            }
                        }
                    ],
                    "tool_call": {
                        "id": "call_002",
                        "type": "function",
                        "function": {
                            "name": "set_timer_and_meeting",
                            "arguments": "{\"timer_duration\": \"300\", \"meeting_date\": \"tomorrow\", \"meeting_time\": \"3 PM\"}"
                        }
                    }
                },
                "output": {
                    "evidence": "Tool spec requires: timer_duration (string matching pattern '^\\d+\\s+(minutes?|seconds?|hours?)$'), meeting_date (string, YYYY-MM-DD format), meeting_time (string, HH:MM 24-hour format). Values provided: '300' (no unit, violates pattern), 'tomorrow' (not YYYY-MM-DD), '3 PM' (not 24-hour format).",
                    "explanation": "All three parameters have significant format violations: timer_duration '300' lacks the required unit and space (should be '5 minutes'), meeting_date 'tomorrow' doesn't follow YYYY-MM-DD format (should be '2025-08-07'), and meeting_time '3 PM' uses 12-hour format instead of required 24-hour HH:MM (should be '15:00'). These errors will likely cause API rejection.",
                    "output": 2,
                    "confidence": 0.92,
                    "correction": {
                        "parameter_issues": [
                            {
                                "parameter_name": "timer_duration",
                                "reason_types": [
                                    "FORMAT_ERROR",
                                    "UNIT_ERROR"
                                ],
                                "reasons": "Value '300' lacks required unit and space format, should be '5 minutes'",
                                "corrected_value": {
                                    "timer_duration": "5 minutes"
                                }
                            },
                            {
                                "parameter_name": "meeting_date",
                                "reason_types": [
                                    "FORMAT_ERROR"
                                ],
                                "reasons": "Value 'tomorrow' doesn't follow required YYYY-MM-DD format",
                                "corrected_value": {
                                    "meeting_date": "2025-08-07"
                                }
                            },
                            {
                                "parameter_name": "meeting_time",
                                "reason_types": [
                                    "FORMAT_ERROR"
                                ],
                                "reasons": "Value '3 PM' uses 12-hour format instead of required 24-hour HH:MM",
                                "corrected_value": {
                                    "meeting_time": "15:00"
                                }
                            }
                        ],
                        "tool_call": {
                            "name": "set_timer_and_meeting",
                            "arguments": {
                                "timer_duration": "5 minutes",
                                "meeting_date": "2025-08-07",
                                "meeting_time": "15:00"
                            }
                        }
                    },
                    "actionable_recommendations": [
                        {
                            "recommendation": "PARAMETER_EXAMPLES",
                            "parameter_name": "timer_duration",
                            "details": "Add clear examples in the API documentation showing timer_duration as '5 minutes', meeting_date as '2025-08-07', and meeting_time as '15:00' to prevent format confusion.",
                            "quote": "Examples: `{ \"timer_duration\": \"5 minutes\" }`, `{ \"timer_duration\": \"10 seconds\" }`"
                        },
                        {
                            "recommendation": "SYSTEM_PROMPT_ADDITIONS",
                            "parameter_name": "timer_duration",
                            "details": "Add to system prompt to always convert relative dates, 12-hour times, and ensure timer durations include both number and unit with a space before calling tools.",
                            "quote": "Always convert relative dates like 'tomorrow' to YYYY-MM-DD format, convert 12-hour time to 24-hour HH:MM format, and ensure timer durations include both number and unit with a space."
                        },
                        {
                            "recommendation": "PARAMETER_VALIDATION",
                            "parameter_name": "timer_duration",
                            "details": "Implement pre-call validation to check timer_duration pattern, date format compliance, and time format before making tool calls.",
                            "quote": "Validate 'timer_duration' matches pattern '^\\d+\\s+(minutes?|seconds?|hours?)$', 'meeting_date' is in 'YYYY-MM-DD', and 'meeting_time' is in 'HH:MM' 24-hour format before calling the tool."
                        }
                    ]
                }
            }
        ]
    },
    {
        "name": "general_conversation_grounded_correctness",
        "task_description": "Evaluate the overall correctness and appropriateness of the tool call based SOLELY on the conversation context, WITHOUT requiring explicit tool specifications. This metric assesses whether the tool call is a logical, non-redundant action that is fully grounded in the conversation history.\n\n**IMPORTANT**: If tool specifications appear in the conversation (e.g., in system prompts or assistant messages), you MAY use them to enhance your assessment. However, your primary focus should be on conversation grounding.\n\n---\n\n### 1. Tool Call Appropriateness\n\nAssess whether the tool call makes sense given the conversation flow:\n\n- **Intent Alignment**: Does the tool call directly address the user's request or a logical next step?\n- **Non-Redundancy**: Is this tool call necessary, or has equivalent information already been obtained?\n- **Timing**: Are there prerequisite actions that should have been completed first?\n- **Relevance**: Is the chosen function appropriate for the current conversation context?\n\n---\n\n### 2. Conversation Grounding Hierarchy\n\nParameter values should be grounded in the following priority order:\n\n1. **Tool Outputs** (highest priority): Values from previous tool call results\n2. **Explicit User Statements**: Direct mentions in user messages\n3. **Confirmed Assistant Statements**: Information the assistant provided that the user acknowledged\n4. **Logical Inference**: Values that can be reasonably inferred from context (use cautiously)\n\n**Key Principle**: When there's a conflict between sources, tool outputs take precedence over user/assistant statements, as they represent ground truth from the system.\n\n---\n\n### 3. Parameter Value Assessment\n\nFor each parameter in the tool call:\n\n- **Explicit Grounding**: Is the value directly stated in the conversation?\n- **Implicit Grounding**: Can the value be reasonably inferred from context?\n- **Assumption Detection**: Is the value assumed without any conversational basis?\n- **Conflict Resolution**: If multiple sources provide different values, is the most authoritative source used?\n\n---\n\n### 4. Format and Consistency (Conversation-Based)\n\nEven without formal specifications:\n\n- **Internal Consistency**: Do parameter values make logical sense together (e.g., end_date after start_date)?\n- **Observable Patterns**: If tool specifications are mentioned in the conversation, do values conform to described patterns?\n- **Common Sense Validation**: Do values follow basic logical constraints (e.g., no negative quantities for counts)?\n\n---\n\n### 5. Prerequisite Satisfaction\n\nCheck if the tool call has all necessary preconditions:\n\n- **Dependent Information**: Is all required information available from the conversation or prior tool calls?\n- **State Requirements**: Based on conversation context, is the system in the right state for this call?\n- **Missing Steps**: Are there obvious gaps in the conversation that should be addressed first?\n\n---\n\n### Correctness Rating Scale\n\n- **5 - Fully Correct**: Tool call is perfectly appropriate, all parameters are explicitly or clearly inferably grounded in conversation, no redundancy, all prerequisites satisfied\n- **4 - Mostly Correct**: Tool call is appropriate and well-grounded, with only minor implicit inferences that are very reasonable\n- **3 - Partially Correct**: Tool call is generally appropriate but has some parameters with weak grounding or minor timing/relevance issues\n- **2 - Problematic**: Tool call has significant issuesâ€”multiple ungrounded parameters, questionable relevance, or missing prerequisites\n- **1 - Incorrect**: Tool call is inappropriate, redundant, or has parameters that are clearly fabricated or contradict conversation context\n\n---\n\n### Evaluation Guidelines\n\n- **Conservative Assessment**: When grounding is unclear, prefer lower scores\n- **Prioritize Tool Outputs**: Always favor values from tool results over human statements\n- **Consider Conversation Flow**: Assess whether the tool call makes sense in the sequence of events\n- **Watch for Hallucinations**: Flag any parameters that appear without conversational basis\n- **Use Available Specs**: If tool specifications appear in the conversation, incorporate them into your assessment\n\nYour evaluation should reflect a holistic view of whether a human reviewing the conversation would consider this tool call to be correct, appropriate, and fully justified by the available information.",
        "jsonschema": {
            "title": "general_conversation_grounded_correctness",
            "description": "Holistic assessment of tool call correctness based on conversation grounding, appropriateness, and logical consistency without requiring explicit tool specifications.",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "evidence": {
                    "type": "string",
                    "description": "Provide EXACT quotes from the conversation that support or contradict the tool call. Include: (1) relevant user messages, (2) assistant messages, (3) prior tool outputs, and (4) any tool specifications mentioned in the conversation. Organize evidence by parameter and by aspect (appropriateness, grounding, prerequisites)."
                },
                "explanation": {
                    "type": "string",
                    "description": "Provide an analysis covering: (1) Tool Call Appropriateness - why this tool call makes sense (or doesn't) in the conversation flow, (2) Parameter Grounding - for EACH parameter, explain its grounding source and quality, noting conflicts between sources and resolution, (3) Prerequisites - whether all necessary preconditions are satisfied, (4) Format and Consistency - whether parameters make logical sense together, (5) Overall Correctness - summary judgment on whether the tool call is fully justified by the conversation."
                },
                "output": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5,
                    "threshold_low": 4,
                    "threshold_high": 5,
                    "description": "Overall Correctness Score (1-5):\n\n5 - Fully Correct: Tool call is the right action at the right time. All parameters are explicitly grounded in conversation (user messages, confirmed assistant statements, or tool outputs). No redundancy. All prerequisites satisfied. If tool specs are in conversation, the call aligns with them.\nExample: User asks \"What's the weather in Boston?\", assistant calls get_weather(location=\"Boston\") with no prior weather call for Boston.\n\n4 - Mostly Correct: Tool call is appropriate and timely. Most parameters are explicitly grounded, a few may be reasonably inferred from clear context. No significant issues. Prerequisites satisfied.\nExample: User says \"Book a table for dinner tonight\", assistant calls book_restaurant(date=\"2025-12-17\", time=\"19:00\", party_size=2) where date is inferred from 'tonight' and party_size from typical default.\n\n3 - Partially Correct: Tool call is generally appropriate but has noticeable issuesâ€”some parameters are weakly grounded, minor relevance concerns, or unclear if prerequisites are met. The call might work but has questionable elements.\nExample: User says \"I need a hotel\", assistant calls book_hotel(location=\"New York\", check_in=\"2025-12-20\") where location and dates aren't mentioned in conversation.\n\n2 - Problematic: Tool call has significant correctness issuesâ€”multiple parameters lack grounding, the timing is questionable, important prerequisites are missing, or the call seems partially redundant. Likely to fail or produce incorrect results.\nExample: User asks \"What flights are available?\", but assistant calls book_flight(...) with specific dates and destinations not discussed, skipping the search step.\n\n1 - Incorrect: Tool call is inappropriate, clearly redundant, or fundamentally misaligned with conversation. Parameters are fabricated or contradict known information. Missing critical prerequisites. The call should not be made.\nExample: User asks about restaurant recommendations, assistant calls cancel_reservation(reservation_id=\"12345\") with no prior discussion of cancellations or that ID."
                },
                "confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "threshold_low": 0,
                    "threshold_high": 1,
                    "description": "Confidence in the accuracy of this assessment (range: 0.0-1.0). Higher confidence when conversation context is clear and complete. Lower confidence when context is ambiguous, conversation is incomplete, or tool specifications are not available."
                },
                "correction": {
                    "type": "object",
                    "description": "Corrections for the tool call. For correct calls (output >= 4), return {}. For problematic calls (output <= 3), provide either need_more_information OR corrected_tool_call.\n\nCRITICAL FORMAT REQUIREMENT: When providing corrected_tool_call, the 'arguments' field MUST be a JSON object/dict (e.g., {\"key\": \"value\"}), NOT a JSON string (e.g., NOT \"{\\\"key\\\": \\\"value\\\"}\").",
                    "properties": {
                        "need_more_information": {
                            "type": "array",
                            "description": "List of questions to ask the user if information is missing. Each question should be specific and actionable.",
                            "items": {
                                "type": "string"
                            }
                        },
                        "corrected_tool_call": {
                            "type": "object",
                            "description": "Complete corrected tool call with all issues addressed. Only provide if correction is possible without additional user input. IMPORTANT: The 'arguments' field must be a JSON object (dict), not a JSON string.",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "Name of the function to call."
                                },
                                "arguments": {
                                    "type": "object",
                                    "description": "Corrected arguments for the function call as a JSON object (not a string). Example: {\"param1\": \"value1\", \"param2\": 123}",
                                    "additionalProperties": true
                                }
                            },
                            "required": ["name", "arguments"]
                        }
                    },
                    "required": []
                },
                "actionable_recommendations": {
                    "type": "array",
                    "description": "Provide clear, actionable recommendations that can be automatically applied to improve conversation grounding. Only include recommendations when there are actual issues (output <= 3). Focus on:\n\n1. SYSTEM_PROMPT_INSTRUCTION: Add a general instruction to the system prompt about grounding, prerequisites, or clarification (do not mention specific parameter names).",
                    "items": {
                        "type": "object",
                        "properties": {
                            "recommendation": {
                                "type": "string",
                                "enum": [
                                    "SYSTEM_PROMPT_INSTRUCTION"
                                ],
                                "description": "The type of recommendation being made."
                            },
                            "details": {
                                "type": "string",
                                "description": "Brief explanation of what should be changed and why."
                            },
                            "quote": {
                                "type": "string",
                                "description": "Exact text to add to documentation or system prompt. Must be directly usable without modification."
                            }
                        },
                        "required": [
                            "recommendation",
                            "details",
                            "quote"
                        ]
                    }
                }
            },
            "required": [
                "evidence",
                "explanation",
                "output",
                "confidence",
                "correction",
                "actionable_recommendations"
            ]
        },
        "examples": [
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "What's the weather like in Boston?"
                        }
                    ],
                    "tool_call": {
                        "id": "call_001",
                        "type": "function",
                        "function": {
                            "name": "get_weather",
                            "arguments": "{\"location\": \"Boston\"}"
                        }
                    }
                },
                "output": {
                    "evidence": "User message: \"What's the weather like in Boston?\"\nTool call parameter: location=\"Boston\"\nNo prior tool calls in conversation.",
                    "explanation": "Tool Call Appropriateness: The tool call directly addresses the user's explicit request for weather information. It's timely, relevant, and non-redundant.\n\nParameter Grounding: The 'location' parameter value \"Boston\" is explicitly mentioned in the user's question, providing perfect grounding.\n\nPrerequisites: No prerequisites are needed for a weather query beyond having the location, which is provided.\n\nFormat and Consistency: The location parameter is a simple string matching the user's input, internally consistent.\n\nOverall Correctness: This tool call is perfectly appropriate and fully grounded in the conversation.",
                    "output": 5,
                    "confidence": 0.98,
                    "correction": {},
                    "actionable_recommendations": []
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "I want to book a flight."
                        },
                        {
                            "role": "assistant",
                            "content": "I'd be happy to help you book a flight. Could you please provide the departure city, destination, and travel dates?"
                        }
                    ],
                    "tool_call": {
                        "id": "call_002",
                        "type": "function",
                        "function": {
                            "name": "book_flight",
                            "arguments": "{\"departure\": \"New York\", \"destination\": \"Los Angeles\", \"date\": \"2025-12-25\"}"
                        }
                    }
                },
                "output": {
                    "evidence": "User message: \"I want to book a flight.\"\nAssistant message: \"Could you please provide the departure city, destination, and travel dates?\"\nTool call parameters: departure=\"New York\", destination=\"Los Angeles\", date=\"2025-12-25\"\nNo user response providing the requested information.",
                    "explanation": "Tool Call Appropriateness: The tool call is premature and inappropriate. The assistant explicitly asked the user for departure city, destination, and dates, but the user has not yet provided this information. Making the booking call now is incorrect.\n\nParameter Grounding: All three parameters (departure, destination, date) are completely ungrounded. They do not appear anywhere in the conversation and represent pure hallucination. The user only expressed a general intent to book a flight.\n\nPrerequisites: The critical prerequisiteâ€”obtaining the necessary booking information from the userâ€”has not been satisfied. The assistant asked for this information but didn't wait for the response.\n\nFormat and Consistency: While the parameters themselves are internally consistent (valid city names and date format), they have no basis in reality for this conversation.\n\nOverall Correctness: This tool call is fundamentally incorrect and should not be made. The system should wait for user input before proceeding.",
                    "output": 1,
                    "confidence": 0.95,
                    "correction": {
                        "need_more_information": [
                            "What city will you be departing from?",
                            "What is your destination?",
                            "What date would you like to travel?"
                        ]
                    },
                    "actionable_recommendations": [
                        {
                            "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                            "details": "Add instruction to wait for user responses before making tool calls.",
                            "quote": "If you ask the user for information, you must wait for their response before making any tool calls that require that information. Never fabricate or assume parameter values."
                        },
                        {
                            "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                            "details": "Add instruction about prerequisite checking.",
                            "quote": "Before making tool calls, verify that all required information is available in the conversation. If any required parameter is missing, ask the user to provide it first."
                        }
                    ]
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "Get me the user profile for the logged-in user."
                        },
                        {
                            "role": "assistant",
                            "content": null,
                            "tool_calls": [
                                {
                                    "id": "call_001",
                                    "type": "function",
                                    "function": {
                                        "name": "get_current_user_id",
                                        "arguments": "{}"
                                    }
                                }
                            ]
                        },
                        {
                            "role": "tool",
                            "tool_call_id": "call_001",
                            "content": "{\"user_id\": 42, \"username\": \"john_doe\"}"
                        },
                        {
                            "role": "assistant",
                            "content": "I found that you're logged in as john_doe (user ID: 42). Let me get your full profile now."
                        }
                    ],
                    "tool_call": {
                        "id": "call_002",
                        "type": "function",
                        "function": {
                            "name": "get_user_profile",
                            "arguments": "{\"user_id\": 42}"
                        }
                    }
                },
                "output": {
                    "evidence": "User message: \"Get me the user profile for the logged-in user.\"\nPrior tool call: get_current_user_id()\nTool output: {\"user_id\": 42, \"username\": \"john_doe\"}\nAssistant confirmation: \"you're logged in as john_doe (user ID: 42)\"\nCurrent tool call: get_user_profile(user_id=42)",
                    "explanation": "Tool Call Appropriateness: The tool call is perfectly appropriate and represents the logical next step. The user requested the profile for the logged-in user. The assistant first identified the user (ID: 42) via a tool call, confirmed this with the user, and is now proceeding to fetch the full profile.\n\nParameter Grounding: The 'user_id' parameter value of 42 is grounded in the tool output from get_current_user_id. This is the highest-quality grounding source (tool output), taking precedence over any human statements.\n\nPrerequisites: All prerequisites are satisfiedâ€”the user ID was obtained through a prior tool call, which is the proper way to get this information before fetching the profile.\n\nFormat and Consistency: The user_id is an integer (42) which is appropriate for an ID field. It's consistent with the value returned from the authentication check.\n\nOverall Correctness: This tool call demonstrates excellent conversation flowâ€”proper sequencing, authoritative grounding from tool output, and clear alignment with user intent.",
                    "output": 5,
                    "confidence": 0.97,
                    "correction": {},
                    "actionable_recommendations": []
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "Book a table for dinner tonight at 7 PM."
                        }
                    ],
                    "tool_call": {
                        "id": "call_003",
                        "type": "function",
                        "function": {
                            "name": "book_restaurant",
                            "arguments": "{\"date\": \"2025-12-17\", \"time\": \"19:00\", \"party_size\": 2}"
                        }
                    }
                },
                "output": {
                    "evidence": "User message: \"Book a table for dinner tonight at 7 PM.\"\nTool call parameters: date=\"2025-12-17\", time=\"19:00\", party_size=2\nCurrent date context: December 17, 2025\nNo mention of restaurant name or party size in conversation.",
                    "explanation": "Tool Call Appropriateness: The tool call is generally appropriate as it responds to the user's booking request. However, it's missing a critical piece of informationâ€”which restaurant to book.\n\nParameter Grounding:\n- 'date': The value \"2025-12-17\" is a reasonable inference from \"tonight\" given the current date context. This is a clear implicit inference (score: 4 level).\n- 'time': The value \"19:00\" (7 PM in 24-hour format) is explicitly grounded in the user's statement \"7 PM\". This is well-grounded.\n- 'party_size': The value 2 is an assumption with no basis in the conversation. The user didn't mention how many people. This is a hallucination.\n\nPrerequisites: The restaurant name/location is missing, which is typically a required prerequisite for booking. The user should specify which restaurant.\n\nFormat and Consistency: The parameters are internally consistent (date is today, time is evening, party size is positive), but the party_size lacks grounding.\n\nOverall Correctness: The tool call has mixed qualityâ€”some parameters are well-grounded while others are assumed. The missing restaurant information is also problematic.",
                    "output": 3,
                    "confidence": 0.85,
                    "correction": {
                        "need_more_information": [
                            "Which restaurant would you like to book?",
                            "How many people will be dining?"
                        ]
                    },
                    "actionable_recommendations": [
                        {
                            "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                            "details": "Add instruction about when inference is acceptable vs. when to ask.",
                            "quote": "Temporal references like 'tonight' or 'tomorrow' can be inferred from the current date. However, user-specific values like party size, number of travelers, or personal preferences must never be assumedâ€”always ask the user if not explicitly provided."
                        }
                    ]
                }
            },
            {
                "user_kwargs": {
                    "conversation_context": [
                        {
                            "role": "user",
                            "content": "I need a reservation at The French Bistro for 2 people tomorrow at 7 PM."
                        },
                        {
                            "role": "assistant",
                            "content": "I'll book a table for you at The French Bistro."
                        }
                    ],
                    "tool_call": {
                        "id": "call_004",
                        "type": "function",
                        "function": {
                            "name": "book_restaurant",
                            "arguments": "{\"restaurant_name\": \"The French Bistro\", \"date\": \"2025-12-18\", \"time\": \"19:00\", \"party_size\": 4, \"dietary_restrictions\": [\"vegetarian\"]}"
                        }
                    }
                },
                "output": {
                    "evidence": "User message: \"I need a reservation at The French Bistro for 2 people tomorrow at 7 PM.\"\nTool call parameters: restaurant_name=\"The French Bistro\", date=\"2025-12-18\", time=\"19:00\", party_size=4, dietary_restrictions=[\"vegetarian\"]\nCurrent date context: December 17, 2025",
                    "explanation": "Tool Call Appropriateness: The tool call is appropriate in intent but has parameter errors.\n\nParameter Grounding:\n- 'restaurant_name': \"The French Bistro\" is explicitly grounded.\n- 'date': \"2025-12-18\" is correctly inferred from \"tomorrow\".\n- 'time': \"19:00\" is explicitly grounded in \"7 PM\".\n- 'party_size': Value is 4, but user explicitly said \"2 people\" - this is a contradiction.\n- 'dietary_restrictions': [\"vegetarian\"] is completely ungrounded - user never mentioned dietary restrictions.\n\nOverall Correctness: Significant issues with party_size contradiction and hallucinated dietary_restrictions.",
                    "output": 2,
                    "confidence": 0.9,
                    "correction": {
                        "corrected_tool_call": {
                            "name": "book_restaurant",
                            "arguments": {
                                "restaurant_name": "The French Bistro",
                                "date": "2025-12-18",
                                "time": "19:00",
                                "party_size": 2
                            }
                        }
                    },
                    "actionable_recommendations": [
                        {
                            "recommendation": "SYSTEM_PROMPT_INSTRUCTION",
                            "details": "Add instruction to verify numbers carefully.",
                            "quote": "When users provide specific quantities (party size, number of guests, passenger count, etc.), use the exact number stated. Never modify or assume different quantities unless explicitly confirmed by the user."
                        }
                    ]
                }
            }
        ]
    }
]